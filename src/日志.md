# 日志配置相关
Nginx 的日志文件管理本身不具备按时间段自动分割日志的功能，但可以通过与系统的日志轮转工具（如 `logrotate`）结合使用，来按时间周期（如每 7 天）生成新的日志文件。以下是一个使用 `logrotate` 来每 7 天分割 Nginx 日志的示例：

### 步骤 1：安装 `logrotate`
通常，`logrotate` 已预装在大多数 Linux 发行版中。如果没有安装，可以使用以下命令安装：

```bash
# CentOS
sudo yum install logrotate
# Ubuntu/Debian
sudo apt install logrotate
```

### 步骤 2：配置 `logrotate` 规则

`logrotate` 的配置文件通常位于 `/etc/logrotate.d/` 目录。你可以为 Nginx 创建一个自定义配置文件，例如 `/etc/logrotate.d/nginx`，内容如下：

```bash
/var/log/nginx/*.log {
    weekly             # 每周分割一次
    rotate 4           # 保留 4 个日志文件（即保存 4 周的日志）
    missingok          # 如果日志文件不存在则跳过，不会报错
    notifempty         # 如果日志文件为空则不分割
    compress           # 分割后的日志文件压缩（通常为 .gz 文件）
    delaycompress      # 推迟压缩到下一个轮转周期
   # create 0640 nginx nginx  # 新日志文件的权限和所有者
   create 0640 root root  # 新日志文件的权限和所有者
    sharedscripts
    postrotate
        systemctl reload nginx  # 日志分割后重新加载 Nginx
    endscript
}
```

### 步骤 3：手动测试配置
完成配置后，你可以手动运行 `logrotate` 来测试配置是否正确：

```bash
sudo logrotate -d /etc/logrotate.d/nginx
```

如果没有错误，你可以使用以下命令强制执行日志轮转：

```bash
sudo logrotate -f /etc/logrotate.d/nginx
```

### 步骤 4：检查和验证
确保你的系统定时任务（`cron`）正常工作，因为 `logrotate` 通常由系统的 `cron` 定时任务驱动。如果你希望确保日志轮转按计划执行，可以检查 `/etc/cron.daily/logrotate` 任务的执行情况。

通过这种方式，Nginx 的日志文件将每 7 天自动分割并保存。